TEAM:

Chinmay Bake
Sneha Susan Varghese

Data Warehousing Assignment 2 

Spring 2021 


--QUERY 1
Select STORE,CITY,STATE,ZIP_CODE
from STORE
where STATE = 'CA' or STATE= 'TX'
ORDER by STATE,CITY;

--QUERY 2
SELECT TOP(1) CUSTOMER.CUST_ID AS CUSTOMER_ID ,TRANSACTION_AMOUNT,TRAN_DATE AS TRANSACTION_DATE,CITY,STATE, ZIP_CODE AS 'ZIP CODE'
FROM CUSTOMER INNER JOIN
(SELECT CUST_ID, MAX(TRANSACT.TRAN_AMT) AS TRANSACTION_AMOUNT, TRAN_DATE
FROM TRANSACT
WHERE TRAN_TYPE='P'
GROUP BY CUST_ID,TRAN_DATE) AS TRANS ON CUSTOMER.CUST_ID=TRANS.CUST_ID
WHERE STATE='TX'
ORDER BY TRANSACTION_AMOUNT DESC;

--QUERY 3
SELECT STORE.STORE, STORE.CITY, STORE.STATE, TRANS.TOTAL_PURCHASE_AMOUNT
FROM STORE INNER JOIN (SELECT STORE,SUM(TRAN_AMT) AS TOTAL_PURCHASE_AMOUNT
 FROM TRANSACT
 WHERE TRAN_TYPE='P' AND TRAN_DATE LIKE '2015%'
 GROUP BY STORE) AS TRANS ON STORE.STORE=TRANS.STORE
 WHERE STATE='TX';

--QUERY 4
SELECT  YEAR,SUM(TOTAL_PURCHASE_AMT) AS TOTAL_DOLLAR_AMOUNT_OF_PURCHASE
FROM STORE INNER JOIN (SELECT SUM(TRAN_AMT)AS TOTAL_PURCHASE_AMT, STORE,YEAR(TRAN_DATE) AS YEAR
FROM TRANSACT
GROUP BY STORE,YEAR(TRAN_DATE)) AS TRANS ON STORE.STORE=TRANS.STORE
WHERE STATE='TX'
GROUP BY YEAR;


--QUERY 5
Select DISTINCT SKU.SKU AS 'PRODUCT SKU', DEPT_DESC AS 'DEPARTMENT DESCRIPTION', DEPTDEC_DESC,COLOR,RETAIL AS 'RETAIL PRICE',SKU_SIZE AS 'SIZE'
from SKU inner join SKU_STORE on SKU.SKU=SKU_STORE.SKU
INNER JOIN DEPARTMENT ON SKU.DEPT=DEPARTMENT.DEPT
WHERE SKU.COLOR LIKE'%NAVY%' AND DEPARTMENT.DEPTDEC_DESC='CAREER' AND CLASSIFICATION LIKE'%Sweater%' AND SKU_STORE.RETAIL<=100.00 AND (DEPARTMENT.DEPT_DESC IN ('Jones Signature','Daniel Cremieux'))
ORDER BY DEPT_DESC desc, SKU_SIZE;



--QUERY 6
SELECT  TOP 1 DEPARTMENT.DEPT_DESC, SUM(TRAN_AMT) AS 'TOTAL DOLLAR SALES AMOUNT'
FROM SKU INNER JOIN DEPARTMENT ON DEPARTMENT.DEPT=SKU.DEPT
INNER JOIN TRANSACT ON TRANSACT.SKU=SKU.SKU
WHERE SKU.CLASSIFICATION='PERFUME/COLOGNE'
GROUP BY DEPARTMENT.DEPT_DESC
ORDER BY 'TOTAL DOLLAR SALES AMOUNT' DESC;

--QUERY 7
SELECT CUSTOMER.CUST_ID AS 'CUSTOMER ID', CITY,STATE,ZIP_CODE AS 'ZIP CODE',TOTAL AS 'TOTAL PURCHASE AMOUNT'
FROM CUSTOMER INNER JOIN (SELECT TRANSACT.CUST_ID, SUM(TRAN_AMT) AS TOTAL
FROM TRANSACT
GROUP BY TRANSACT.CUST_ID) AS TRANS ON TRANS.CUST_ID=CUSTOMER.CUST_ID
WHERE TOTAL>=15000.00 AND STATE='TX'
ORDER BY TOTAL DESC;

--QUERY 8
SELECT  DEPARTMENT.DEPT AS 'DEPARTMENT CODE', DEPT_DESC AS 'DEPARTMENT DESCRIPTION', DEPTDEC_DESC, DEPTCENT,DEPTCENT_DESC
FROM DEPARTMENT LEFT OUTER JOIN  SKU ON SKU.DEPT=DEPARTMENT.DEPT
WHERE SKU.DEPT IS NULL AND DEPTCENT_DESC<>'LEASE';

--QUERY 9
SELECT STORE.STORE, STORE.CITY, STATE, ZIP_CODE AS 'ZIP CODE' , NUMBER_OF_ITEMS 
FROM STORE INNER JOIN (SELECT STORE, COUNT(SKU) AS NUMBER_OF_ITEMS FROM SKU_STORE WHERE RETAIL>=500.00 GROUP BY STORE) AS SK on STORE.STORE=SK.STORE
ORDER BY NUMBER_OF_ITEMS DESC;

--QUERY 10
SELECT DISTINCT CUSTOMER.CUST_ID AS 'CUSTOMER ID', CUSTOMER.CITY, CUSTOMER.STATE, CUSTOMER.ZIP_CODE AS 'ZIP CODE', DEPARTMENT.DEPT_DESC
FROM CUSTOMER INNER JOIN TRANSACT ON CUSTOMER.CUST_ID = TRANSACT.CUST_ID
INNER JOIN SKU ON TRANSACT.ITEM_ID = SKU.ITEM_ID
INNER JOIN DEPARTMENT ON DEPARTMENT.DEPT = SKU.DEPT
WHERE DEPARTMENT.DEPT_DESC IN (SELECT DEPT_DESC FROM DEPARTMENT WHERE DEPT_DESC LIKE '%CHANEL%' OR DEPT_DESC LIKE '%ARMANI%')
AND CUSTOMER.STATE = 'TX'
AND CUSTOMER.CUST_ID IN (SELECT CUSTOMER.CUST_ID FROM CUSTOMER
                         INNER JOIN TRANSACT ON CUSTOMER.CUST_ID = TRANSACT.CUST_ID
						 INNER JOIN SKU ON SKU.ITEM_ID = TRANSACT.ITEM_ID
						 INNER JOIN DEPARTMENT ON DEPARTMENT.DEPT = SKU.DEPT
						 WHERE DEPARTMENT.DEPT_DESC LIKE '%CHANEL%' AND CUSTOMER.CUST_ID IN 
						 (SELECT CUSTOMER.CUST_ID FROM CUSTOMER
                         INNER JOIN TRANSACT ON CUSTOMER.CUST_ID = TRANSACT.CUST_ID
						 INNER JOIN SKU ON SKU.ITEM_ID = TRANSACT.ITEM_ID
						 INNER JOIN DEPARTMENT ON DEPARTMENT.DEPT = SKU.DEPT
						 WHERE DEPARTMENT.DEPT_DESC LIKE '%ARMANI%')) ORDER BY CUSTOMER.CITY,
						 CUSTOMER.ZIP_CODE;
